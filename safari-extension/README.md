# Safari Extension - çŸ¥è¯†åº“å¿«é€Ÿæ•è·

Safariæµè§ˆå™¨æ‰©å±•ï¼Œç”¨äºå¿«é€Ÿä¿å­˜ç½‘é¡µå†…å®¹åˆ°ä¸ªäººçŸ¥è¯†åº“ã€‚

## ç³»ç»Ÿè¦æ±‚

- **Safari 14+** (macOS Big Sur 11.0+ æˆ– iOS 14+)
- æœ¬åœ°åç«¯æœåŠ¡è¿è¡Œåœ¨ `http://localhost:5001`

## å®‰è£…æ­¥éª¤

### åœ¨ macOS Safari ä¸Šå®‰è£…

1. **å¯ç”¨å¼€å‘è€…èœå•**
   - æ‰“å¼€ Safari
   - èœå•æ é€‰æ‹© `Safari > è®¾ç½®` (æˆ– `Preferences`)
   - ç‚¹å‡» `é«˜çº§` æ ‡ç­¾
   - å‹¾é€‰ `åœ¨èœå•æ ä¸­æ˜¾ç¤ºå¼€å‘èœå•`

2. **åŠ è½½æ‰©å±•**
   - èœå•æ é€‰æ‹© `å¼€å‘ > å…è®¸æœªç­¾åçš„æ‰©å±•` (å¯é€‰ï¼Œé¦–æ¬¡ä½¿ç”¨éœ€è¦)
   - èœå•æ é€‰æ‹© `å¼€å‘ > Web æ‰©å±• > æ˜¾ç¤ºç½‘é¡µæ£€æŸ¥å™¨`
   - æˆ–è€…ç›´æ¥æ‰“å¼€ `Safari > åå¥½è®¾ç½® > æ‰©å±•`
   - ç‚¹å‡»å·¦ä¸‹è§’çš„ `+` å·æˆ–å‹¾é€‰ `çŸ¥è¯†åº“å¿«é€Ÿæ•è·`

3. **éªŒè¯å®‰è£…**
   - æµè§ˆå™¨å·¥å…·æ åº”è¯¥å‡ºç°æ‰©å±•å›¾æ ‡
   - ç‚¹å‡»å›¾æ ‡ç¡®è®¤å¯ä»¥æ‰“å¼€è®¾ç½®é¢æ¿

### åœ¨ iOS Safari ä¸Šå®‰è£… (å¯é€‰)

iOSä¸Šå®‰è£…ç¨å¾®å¤æ‚ä¸€äº›ï¼Œéœ€è¦ï¼š
- ä½¿ç”¨Safari Web Extension Converterè½¬æ¢ä¸ºiOSåº”ç”¨
- åœ¨Xcodeä¸­ç¼–è¯‘å¹¶å®‰è£…åˆ°è®¾å¤‡

**å»ºè®®ï¼šä¸»è¦åœ¨macOSä¸Šä½¿ç”¨ï¼ŒiOSä¸Šå¯ä»¥ç›´æ¥ç”¨æµè§ˆå™¨æ·»åŠ åˆ°ä¸»å±å¹•çš„æ–¹å¼è®¿é—®ä½ çš„çŸ¥è¯†åº“Webç•Œé¢**

## é…ç½®

### ç”ŸæˆAPIå¯†é’¥

åœ¨backendç›®å½•ä¸‹è¿è¡Œï¼š

```bash
cd backend
export ADMIN_USERNAME='admin'
export ADMIN_PASSWORD='AdminPass123!'
python3 -c "
from app import app, create_admin_user
from models import generate_api_key, get_user_by_username
with app.app_context():
    create_admin_user()
    user = get_user_by_username('admin')
    key = generate_api_key(user['id'])
    print(f'API Key: {key}')
"
```

### é…ç½®æ‰©å±•

1. ç‚¹å‡»Safariå·¥å…·æ ä¸­çš„æ‰©å±•å›¾æ ‡
2. ç‚¹å‡»è®¾ç½® (é½¿è½®å›¾æ ‡ âš™ï¸)
3. è¾“å…¥ä½ çš„APIå¯†é’¥
4. ä¿å­˜è®¾ç½®

## ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿæ•è·

1. åœ¨ä»»ä½•ç½‘é¡µä¸Šé€‰ä¸­æ–‡å­—
2. ç‚¹å‡»æµ®åŠ¨å·¥å…·æ ä¸­çš„ ğŸ“Œ æŒ‰é’®
3. å†…å®¹è‡ªåŠ¨ä¿å­˜åˆ°çŸ¥è¯†åº“ï¼

### æ·»åŠ æ ‡ç­¾

1. é€‰ä¸­æ–‡å­—
2. ç‚¹å‡» ğŸ·ï¸ æŒ‰é’®
3. è¾“å…¥æ ‡ç­¾ (ç”¨é€—å·åˆ†éš”ï¼Œå¦‚ `python, æ•™ç¨‹, é‡è¦`)
4. ç‚¹å‡»ç¡®è®¤ä¿å­˜

### æ·»åŠ ç¬”è®°

1. é€‰ä¸­æ–‡å­—
2. ç‚¹å‡» âœï¸ æŒ‰é’®
3. è¾“å…¥ç¬”è®°å†…å®¹
4. ä¿å­˜æ—¶ç¬”è®°ä¼šé™„åŠ åˆ°æ•è·å†…å®¹ä¸Š

## ä¸Chromeç‰ˆæœ¬çš„åŒºåˆ«

Safariç‰ˆæœ¬ä¸Chromeç‰ˆæœ¬**åŠŸèƒ½å®Œå…¨ç›¸åŒ**ï¼Œä»£ç å¤ç”¨ç‡95%+ï¼š

- âœ… ç›¸åŒçš„æµ®åŠ¨å·¥å…·æ 
- âœ… ç›¸åŒçš„å¿«æ·æ•è·åŠŸèƒ½
- âœ… ç›¸åŒçš„APIé€šä¿¡
- âœ… ç›¸åŒçš„æ ‡ç­¾å’Œç¬”è®°æ”¯æŒ

å”¯ä¸€çš„åŒºåˆ«æ˜¯`manifest.json`ä¸­æ·»åŠ äº†Safariç‰¹å®šé…ç½®ï¼š

```json
"browser_specific_settings": {
  "safari": {
    "strict_site_minification": false
  }
}
```

## æ•…éšœæ’é™¤

### æ‰©å±•æ— æ³•åŠ è½½ï¼Ÿ

**æ£€æŸ¥Safariç‰ˆæœ¬ï¼š**
- æ‰“å¼€ `Safari > å…³äºSafari`
- ç¡®ä¿ç‰ˆæœ¬ >= 14.0

**å¯ç”¨å¼€å‘è€…æ¨¡å¼ï¼š**
- `Safari > åå¥½è®¾ç½® > é«˜çº§`
- å‹¾é€‰ `åœ¨èœå•æ ä¸­æ˜¾ç¤ºå¼€å‘èœå•`

### å·¥å…·æ ä¸æ˜¾ç¤ºï¼Ÿ

**ç¡®è®¤æ‰©å±•å·²å¯ç”¨ï¼š**
- `Safari > åå¥½è®¾ç½® > æ‰©å±•`
- ç¡®ä¿ `çŸ¥è¯†åº“å¿«é€Ÿæ•è·` å·²å‹¾é€‰

**æ£€æŸ¥æƒé™ï¼š**
- ç¡®ä¿æ‰©å±•æœ‰è®¿é—®å½“å‰ç½‘ç«™çš„æƒé™
- åœ¨åœ°å€æ å·¦ä¾§ç‚¹å‡»æ‰©å±•å›¾æ ‡ç¡®è®¤

### ä¿å­˜å¤±è´¥ï¼Ÿ

**ç¡®è®¤åç«¯æœåŠ¡è¿è¡Œä¸­ï¼š**
```bash
cd backend
python3 app.py
```

**éªŒè¯APIå¯†é’¥ï¼š**
- æ‰“å¼€æ‰©å±•è®¾ç½®
- é‡æ–°è¾“å…¥APIå¯†é’¥
- ç‚¹å‡» `æµ‹è¯•è¿æ¥`

**æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼š**
- æ‰“å¼€ `å¼€å‘ > Web æ‰©å±• > [æ‰©å±•åç§°]`
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

## æ›´æ–°æ‰©å±•

å½“ä½ ä¿®æ”¹ä»£ç åï¼š

1. åœ¨Safariä¸­æ‰“å¼€ `Safari > åå¥½è®¾ç½® > æ‰©å±•`
2. å–æ¶ˆå‹¾é€‰æ‰©å±•
3. é‡æ–°å‹¾é€‰æ‰©å±•
4. æˆ–è€…ç‚¹å‡» `å¼€å‘ > Web æ‰©å±• > é‡æ–°åŠ è½½ [æ‰©å±•åç§°]`

## å¼€å‘è¯´æ˜

### æ–‡ä»¶ç»“æ„

```
safari-extension/
â”œâ”€â”€ manifest.json          # æ‰©å±•é…ç½® (åŒ…å«Safariç‰¹å®šè®¾ç½®)
â”œâ”€â”€ background/
â”‚   â”œâ”€â”€ api-client.js      # APIå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ auth-manager.js    # è®¤è¯ç®¡ç†
â”‚   â””â”€â”€ service-worker.js  # åå°æœåŠ¡å·¥ä½œ
â”œâ”€â”€ content/
â”‚   â”œâ”€â”€ content-bundle.js  # æ³¨å…¥åˆ°ç½‘é¡µçš„è„šæœ¬
â”‚   â”œâ”€â”€ content.css        # æ ·å¼
â”‚   â”œâ”€â”€ content.js
â”‚   â”œâ”€â”€ selector.js
â”‚   â””â”€â”€ toolbar.js         # æµ®åŠ¨å·¥å…·æ 
â”œâ”€â”€ popup/
â”‚   â”œâ”€â”€ popup.html         # å¼¹å‡ºé¡µé¢
â”‚   â”œâ”€â”€ popup.js
â”‚   â””â”€â”€ popup.css
â””â”€â”€ icons/                 # å›¾æ ‡èµ„æº
```

### ä¸Chromeç‰ˆæœ¬åŒæ­¥

å½“ä½ ä¿®æ”¹Chromeç‰ˆæœ¬æ—¶ï¼Œåªéœ€è¦ï¼š

1. **JavaScript/CSSæ–‡ä»¶** - ç›´æ¥å¤åˆ¶åˆ°safari-extensionå¯¹åº”ç›®å½•
2. **manifest.json** - åˆå¹¶ä¿®æ”¹ï¼Œä¿ç•™`browser_specific_settings`å­—æ®µ

å¿«é€ŸåŒæ­¥å‘½ä»¤ï¼š
```bash
# å¤åˆ¶æ›´æ–°çš„æ–‡ä»¶
cp browser-extension/background/*.js safari-extension/background/
cp browser-extension/content/*.* safari-extension/content/
cp browser-extension/popup/*.* safari-extension/popup/

# ç„¶åæ‰‹åŠ¨åˆå¹¶manifest.jsonçš„ä¿®æ”¹
```

## å‘å¸ƒåˆ°App Store (å¯é€‰)

å¦‚æœä½ æƒ³å…¬å¼€å‘å¸ƒï¼š

1. **æ³¨å†ŒApple Developerè´¦å·** ($99/å¹´)
2. **ä½¿ç”¨Safari Extension Converterè½¬æ¢**
   ```bash
   xcrun safari-web-extension-converter /path/to/safari-extension
   ```
3. **åœ¨Xcodeä¸­é…ç½®åº”ç”¨ä¿¡æ¯**
4. **ä¸Šä¼ åˆ°App Store Connect**
5. **ç­‰å¾…å®¡æ ¸**

**æ³¨æ„ï¼šä¸ªäººä½¿ç”¨ä¸éœ€è¦ä»¥ä¸Šæ­¥éª¤ï¼Œç›´æ¥åŠ è½½æœªç­¾åæ‰©å±•å³å¯**

## æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ

1. æŸ¥çœ‹ä¸»é¡¹ç›®çš„ `browser-extension/README.md` è·å–æ›´å¤šAPIæ–‡æ¡£
2. æ£€æŸ¥ `browser-extension/TESTING.md` äº†è§£æµ‹è¯•æ–¹æ³•
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯æ—¥å¿—

## è®¸å¯è¯

MIT
