{% extends "base.html" %}

{% block title %}{{ author.display_name or author.username }} - ä½œè€…é¡µé¢{% endblock %}

{% block content %}
<div class="container">
    <!-- ä½œè€…ä¿¡æ¯å¡ç‰‡ -->
    <div class="author-card" style="background: var(--code-bg, #f6f8fa); padding: 2rem; border-radius: 12px; margin-bottom: 2rem;">
        <div style="display: flex; align-items: center; gap: 1.5rem;">
            {% if author.avatar_url %}
            <img src="{{ author.avatar_url }}" alt="{{ author.display_name or author.username }}"
                 style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;">
            {% else %}
            <div style="width: 80px; height: 80px; border-radius: 50%; background: var(--primary-color, #10b981);
                        display: flex; align-items: center; justify-content: center; font-size: 2rem;">
                ğŸ‘¤
            </div>
            {% endif %}

            <div>
                <h1 style="margin: 0 0 0.5rem 0;">{{ author.display_name or author.username }}</h1>
                {% if author.bio %}
                <p style="color: var(--text-secondary, #666); margin: 0;">{{ author.bio }}</p>
                {% endif %}
                {% if author.role %}
                <p style="color: var(--text-secondary, #999); margin: 0.5rem 0 0 0; font-size: 0.9rem;">
                    {% if author.role == 'admin' %}ç®¡ç†å‘˜{% elif author.role == 'editor' %}ç¼–è¾‘{% else %}ä½œè€…{% endif %} Â· å…± {{ pagination.total }} ç¯‡æ–‡ç« 
                </p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- æ–‡ç« åˆ—è¡¨ -->
    <h2 style="margin-bottom: 1rem;">æ–‡ç« åˆ—è¡¨</h2>

    {% if posts %}
    <div class="posts-list">
        {% for post in posts %}
        <a href="{{ url_for('view_post', post_id=post.id) }}" class="post-card-link">
            <article class="post-card">
                <h2>{{ post.title }}</h2>
                <div class="post-meta">
                    {% if post.category_name %}
                    <span class="post-category">{{ post.category_name }}</span>
                    <span>Â·</span>
                    {% endif %}
                    <time datetime="{{ post.created_at }}">{{ (post.created_at|localtime)[:10] }}</time>
                </div>
                <div class="post-excerpt">
                    {{ post.content[:200] }}...
                </div>
            </article>
        </a>
        {% endfor %}
    </div>

    <!-- åˆ†é¡µ -->
    {% if pagination.total_pages > 1 %}
    <div class="pagination">
        {% if pagination.page > 1 %}
        <a href="{{ url_for('view_author', author_id=author.id, page=1) }}" class="btn btn-sm">é¦–é¡µ</a>
        <a href="{{ url_for('view_author', author_id=author.id, page=pagination.page-1) }}" class="btn btn-sm">ä¸Šä¸€é¡µ</a>
        {% endif %}

        {% for page_num in page_range %}
        {% if page_num == pagination.page %}
        <span class="btn btn-sm btn-primary">{{ page_num }}</span>
        {% elif page_num > 0 and page_num <= pagination.total_pages %}
        <a href="{{ url_for('view_author', author_id=author.id, page=page_num) }}" class="btn btn-sm">{{ page_num }}</a>
        {% endif %}
        {% endfor %}

        {% if show_ellipsis and pagination.page + 2 < pagination.total_pages %}
        <span>...</span>
        {% endif %}

        {% if pagination.page < pagination.total_pages %}
        <a href="{{ url_for('view_author', author_id=author.id, page=pagination.page+1) }}" class="btn btn-sm">ä¸‹ä¸€é¡µ</a>
        <a href="{{ url_for('view_author', author_id=author.id, page=pagination.total_pages) }}" class="btn btn-sm">æœ«é¡µ</a>
        {% endif %}

        <span>
            ç¬¬ {{ pagination.page }} / {{ pagination.total_pages }} é¡µ
            (å…± {{ pagination.total }} ç¯‡ï¼Œç¬¬ {{ start_item }}-{{ end_item }} ç¯‡)
        </span>
    </div>
    {% endif %}

    {% else %}
    <div class="empty-state">
        <p>è¯¥ä½œè€…è¿˜æ²¡æœ‰å‘å¸ƒä»»ä½•æ–‡ç« ã€‚</p>
    </div>
    {% endif %}
</div>
{% endblock %}
